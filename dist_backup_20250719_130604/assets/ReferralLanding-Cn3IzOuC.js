import{e as L,u as V,r as l,j as e}from"./react-vendor-4KVcW9E9.js";import{j as b,k as m,u as D,t as c,z as d,F as U,h as A}from"./firebase-vendor-DqmTlSD9.js";import{d as i}from"./admin-pages-NPVKbNvB.js";import{a as w}from"./hooks-Dh4rj4GA.js";import{m as g}from"./ui-vendor-DXhXuwYa.js";import"./vendor-CrhDUPGb.js";import"./components-DnyS3Eh5.js";import"./utils-BlHP7G-6.js";function T(){const{referralCode:p}=L(),f=V(),{user:t}=w(),[k,u]=l.useState(!0),[h,x]=l.useState(null),[s,v]=l.useState(null),[R,E]=l.useState(!1);l.useEffect(()=>{(async()=>{if(!p){x("Código de referência inválido"),u(!1);return}try{u(!0);const a=await b(m(i,"users",p.replace("REF","")));if(a.exists())v(a.data());else{const o=await b(m(i,"users",p));if(!o.exists()){x("Código de referência não encontrado"),u(!1);return}v(o.data())}t&&await j(t.uid,(s==null?void 0:s.uid)||""),E(!0)}catch(a){console.error("Erro ao processar referência:",a),x("Erro ao processar referência")}finally{u(!1)}})()},[p,t]);const j=async(n,a)=>{if(!(!a||n===a))try{const r=(await b(m(i,"users",n))).data(),N=r==null?void 0:r.gamification;if(N!=null&&N.referredBy){console.log("Referência já processada");return}await D(m(i,"users",n),{"gamification.referredBy":a,updatedAt:c()}),await D(m(i,"users",a),{"gamification.referrals":d(1),"gamification.referralTokens":d(50),"gamification.tokens.box.balance":d(50),"gamification.tokens.box.totalEarned":d(50),"gamification.totalActions":d(1),"gamification.lastActionAt":c(),updatedAt:c()}),await U(A(i,"gamification_actions"),{userId:a,userEmail:(s==null?void 0:s.email)||"",userName:(s==null?void 0:s.displayName)||"Usuário",action:"indicacao_confirmada",points:50,description:`Indicação confirmada - Novo usuário: ${(r==null?void 0:r.displayName)||"Usuário"}`,metadata:{referredUserId:n,referredUserEmail:r==null?void 0:r.email,referredUserName:r==null?void 0:r.displayName},createdAt:c(),processed:!0,processedAt:c()}),console.log("✅ Referência processada com sucesso!")}catch(o){console.error("Erro ao processar referência:",o)}},y=()=>{f(t?"/":"/login")};return k?e.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-pink-900 flex items-center justify-center",children:e.jsxDEV(g.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-pink-500 mx-auto mb-6"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:134,columnNumber:11},this),e.jsxDEV("h2",{className:"text-2xl font-bold text-white mb-2",children:"Processando..."},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:135,columnNumber:11},this),e.jsxDEV("p",{className:"text-gray-400",children:"Verificando código de referência"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:136,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:129,columnNumber:9},this)},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:128,columnNumber:7},this):h?e.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-pink-900 flex items-center justify-center",children:e.jsxDEV(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md mx-auto p-8",children:[e.jsxDEV("div",{className:"bg-white/5 rounded-xl p-8 border border-white/10 mb-6",children:[e.jsxDEV("div",{className:"text-6xl mb-4",children:"❌"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:151,columnNumber:13},this),e.jsxDEV("h2",{className:"text-2xl font-bold text-white mb-4",children:"Código Inválido"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:152,columnNumber:13},this),e.jsxDEV("p",{className:"text-gray-400 mb-6",children:h},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:155,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:150,columnNumber:11},this),e.jsxDEV("button",{onClick:()=>f("/"),className:"bg-gradient-to-r from-pink-600 to-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:from-pink-700 hover:to-purple-700 transition-all duration-200",children:"Ir para o App"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:160,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:145,columnNumber:9},this)},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:144,columnNumber:7},this):e.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-pink-900 flex items-center justify-center",children:e.jsxDEV(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md mx-auto p-8",children:[e.jsxDEV("div",{className:"bg-white/5 rounded-xl p-8 border border-white/10 mb-6",children:[e.jsxDEV("div",{className:"text-6xl mb-4",children:"🎯"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:179,columnNumber:11},this),e.jsxDEV("h2",{className:"text-2xl font-bold text-white mb-4",children:"Referência Confirmada!"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:180,columnNumber:11},this),s&&e.jsxDEV("div",{className:"mb-6",children:[e.jsxDEV("p",{className:"text-gray-400 mb-2",children:"Você foi convidado por:"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:186,columnNumber:15},this),e.jsxDEV("div",{className:"bg-black/20 rounded-lg p-3 border border-pink-500/20",children:[e.jsxDEV("div",{className:"text-pink-400 font-semibold",children:s.displayName||"Usuário"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:190,columnNumber:17},this),e.jsxDEV("div",{className:"text-gray-400 text-sm",children:s.email},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:193,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:189,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:185,columnNumber:13},this),e.jsxDEV("div",{className:"space-y-4 text-left",children:[e.jsxDEV("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:[e.jsxDEV("h3",{className:"text-green-400 font-semibold mb-2",children:"🎉 Bônus de Boas-vindas!"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:202,columnNumber:15},this),e.jsxDEV("div",{className:"text-sm text-gray-300 space-y-1",children:[e.jsxDEV("div",{children:"• +10 $BOX por usar link de referência"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:204,columnNumber:17},this),e.jsxDEV("div",{children:"• +25 $BOX ao completar seu perfil"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:205,columnNumber:17},this),e.jsxDEV("div",{children:"• +100 $BOX ao comprar ingresso"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:206,columnNumber:17},this),e.jsxDEV("div",{children:"• Acesso a conteúdo exclusivo"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:207,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:203,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:201,columnNumber:13},this),R&&e.jsxDEV("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsxDEV("h3",{className:"text-blue-400 font-semibold mb-2",children:"💰 Recompensa Atribuída!"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:213,columnNumber:17},this),e.jsxDEV("p",{className:"text-sm text-gray-300",children:"Seu amigo ganhou +50 $BOX por te convidar!"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:214,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:212,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:200,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:178,columnNumber:9},this),e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("button",{onClick:y,className:"w-full bg-gradient-to-r from-pink-600 to-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:from-pink-700 hover:to-purple-700 transition-all duration-200",children:t?"Continuar no App":"Fazer Login"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:223,columnNumber:11},this),e.jsxDEV("div",{className:"text-xs text-gray-400",children:"CERRADØ INTERBOX 2025 - O maior evento de times da América Latina"},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:230,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:222,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:173,columnNumber:7},this)},void 0,!1,{fileName:"/Users/nettomello/Desktop/app-fenix/src/pages/ReferralLanding.tsx",lineNumber:172,columnNumber:5},this)}export{T as default};
